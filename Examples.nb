(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     45660,       1313]
NotebookOptionsPosition[     42525,       1209]
NotebookOutlinePosition[     42992,       1227]
CellTagsIndexPosition[     42949,       1224]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<MultivariateResidues.m\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.691410498135199*^9, 3.6914105193420887`*^9}, {
  3.714105659847084*^9, 3.71410566003224*^9}, {3.71410847702621*^9, 
  3.714108529228442*^9}, {3.7141086706737137`*^9, 3.714108676753977*^9}, {
  3.715340984789463*^9, 3.7153409867750387`*^9}, {3.715356551255258*^9, 
  3.7153565568545775`*^9}}],

Cell[BoxData["\<\"MultivariateResidues, Kasper J. Larsen and Robbert Rietkerk \
(2017)\"\>"], "Print",
 CellChangeTimes->{
  3.714108677211384*^9, 3.7141087471836777`*^9, 3.7141088496662397`*^9, 
   3.714109179349704*^9, {3.714109701643776*^9, 3.714106673518406*^9}, {
   3.7153409879410877`*^9, 3.715341001004423*^9}, 3.715341716135703*^9, 
   3.7153565769533653`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MultivariateResidues`*"}]], "Input",
 CellChangeTimes->{{3.69141053136873*^9, 3.6914105313703938`*^9}, {
  3.71410868208878*^9, 3.714108686866641*^9}}],

Cell[BoxData[
 DynamicModuleBox[{Typeset`open$$ = True}, 
  PaneSelectorBox[{False->
   RowBox[{
    OpenerBox[Dynamic[Typeset`open$$],
     ImageSize->Small], 
    StyleBox["MultivariateResidues`", "InfoHeading"]}], True->GridBox[{
     {
      RowBox[{
       OpenerBox[Dynamic[Typeset`open$$],
        ImageSize->Small], 
       StyleBox["MultivariateResidues`", "InfoHeading"]}]},
     {GridBox[{
        {
         ButtonBox["FindMinimumDelta",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info513715360177-5425685", {
            "FindMinimumDelta", "MultivariateResidues`"}},
          ButtonNote->"MultivariateResidues`"], 
         ButtonBox["MultivariateResidue",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info513715360177-5425685", {
            "MultivariateResidue", "MultivariateResidues`"}},
          ButtonNote->"MultivariateResidues`"], 
         ButtonBox["$MultiResInternalChecks",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info513715360177-5425685", {
            "$MultiResInternalChecks", "MultivariateResidues`"}},
          ButtonNote->"MultivariateResidues`"], 
         ButtonBox["$MultiResUseSingular",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info513715360177-5425685", {
            "$MultiResUseSingular", "MultivariateResidues`"}},
          ButtonNote->"MultivariateResidues`"]},
        {
         ButtonBox["GlobalResidue",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info513715360177-5425685", {
            "GlobalResidue", "MultivariateResidues`"}},
          ButtonNote->"MultivariateResidues`"], 
         ButtonBox["$MultiResInputChecks",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info513715360177-5425685", {
            "$MultiResInputChecks", "MultivariateResidues`"}},
          ButtonNote->"MultivariateResidues`"], 
         ButtonBox["$MultiResSingularPath",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info513715360177-5425685", {
            "$MultiResSingularPath", "MultivariateResidues`"}},
          ButtonNote->"MultivariateResidues`"], ""}
       },
       DefaultBaseStyle->"InfoGrid",
       GridBoxItemSize->{"Columns" -> {{
            Scaled[0.2375]}}}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}}]}, 
   Dynamic[Typeset`open$$],
   ImageSize->Automatic]]], "Print", "InfoCell",
 CellChangeTimes->{3.7153565770669537`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["New function", "Subsection",
 CellChangeTimes->{{3.691415892046155*^9, 3.691415895652322*^9}, 
   3.69243559607235*^9}],

Cell["\<\
In the univariate case, MultivariateResidue is equivalent to the native \
Mathematica function Residue. For instance,\
\>", "Text",
 CellChangeTimes->{{3.692435676388291*^9, 3.692435730586062*^9}, {
  3.71410926419031*^9, 3.714109264538348*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MultivariateResidue", "[", 
  RowBox[{
   RowBox[{"f", "[", "z", "]"}], ",", 
   RowBox[{"{", "z", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", "\[Rule]", "0"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Residue", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"f", "[", "z", "]"}], "z"], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "0"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.691410546103413*^9, 3.6914105625265408`*^9}, {
  3.6914106130874157`*^9, 3.691410620795192*^9}}],

Cell[BoxData[
 RowBox[{"f", "[", "0", "]"}]], "Output",
 CellChangeTimes->{
  3.691410564274232*^9, {3.691410607505493*^9, 3.69141062135575*^9}, 
   3.692435605690854*^9, 3.692436348013977*^9, 3.69243638225528*^9, 
   3.692439706424049*^9, 3.6938331875200367`*^9, 3.7140252263927803`*^9, 
   3.714104999668623*^9, 3.714108696423616*^9, 3.714108747275831*^9, 
   3.714108851468364*^9, 3.7141091796941*^9, {3.714109701993744*^9, 
   3.714106673703537*^9}, {3.715340991362071*^9, 3.7153410033322268`*^9}, 
   3.7153417189412622`*^9, 3.7153565770989823`*^9}],

Cell[BoxData[
 RowBox[{"f", "[", "0", "]"}]], "Output",
 CellChangeTimes->{
  3.691410564274232*^9, {3.691410607505493*^9, 3.69141062135575*^9}, 
   3.692435605690854*^9, 3.692436348013977*^9, 3.69243638225528*^9, 
   3.692439706424049*^9, 3.6938331875200367`*^9, 3.7140252263927803`*^9, 
   3.714104999668623*^9, 3.714108696423616*^9, 3.714108747275831*^9, 
   3.714108851468364*^9, 3.7141091796941*^9, {3.714109701993744*^9, 
   3.714106673703537*^9}, {3.715340991362071*^9, 3.7153410033322268`*^9}, 
   3.7153417189412622`*^9, 3.7153565771280317`*^9}]
}, Open  ]],

Cell["\<\
As a multivariate example, let us compute the residues considered in section \
2.1 of the accompanying paper. Taking \[CurlyPhi]_1, \[CurlyPhi]_2 and \
\[CurlyPhi]_3 from eq. (10), we can straightforwardly compute the residues \
with respect to the ideals given in eq. (11) as follows:\
\>", "Text",
 CellChangeTimes->{{3.692514994502585*^9, 3.692515088677052*^9}, {
  3.692515135782708*^9, 3.692515141024228*^9}, {3.694166495918768*^9, 
  3.6941665031789355`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "1", "]"}], "=", 
   RowBox[{"z", "[", "2", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "2", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], " ", 
     RowBox[{"z", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"a", "[", "2", "]"}], " ", 
     RowBox[{"z", "[", "2", "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "3", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"b", "[", "1", "]"}], " ", 
     RowBox[{"z", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"b", "[", "2", "]"}], " ", 
     RowBox[{"z", "[", "2", "]"}]}]}]}], ";"}], "\n", 
 RowBox[{"MultivariateResidue", "[", 
  RowBox[{
   RowBox[{"z", "[", "1", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", "1", "]"}], ",", 
     RowBox[{
      RowBox[{"f", "[", "2", "]"}], "*", 
      RowBox[{"f", "[", "3", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"z", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"z", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}]}], 
  "]"}], "\n", 
 RowBox[{"MultivariateResidue", "[", 
  RowBox[{
   RowBox[{"z", "[", "1", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", "2", "]"}], ",", 
     RowBox[{
      RowBox[{"f", "[", "3", "]"}], "*", 
      RowBox[{"f", "[", "1", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"z", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"z", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}]}], 
  "]"}], "\n", 
 RowBox[{"MultivariateResidue", "[", 
  RowBox[{
   RowBox[{"z", "[", "1", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", "3", "]"}], ",", 
     RowBox[{
      RowBox[{"f", "[", "1", "]"}], "*", 
      RowBox[{"f", "[", "2", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"z", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"z", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.691411312794065*^9, 3.691411341056925*^9}, {
   3.691411381626007*^9, 3.691411383523394*^9}, 3.6924356202581053`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["1", 
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}]}]]}]], "Output",
 CellChangeTimes->{
  3.7141088543864717`*^9, 3.714109179807962*^9, {3.714109702085415*^9, 
   3.714106673770583*^9}, 3.7153410065641108`*^9, 3.715341720520486*^9, 
   3.7153565771690335`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"a", "[", "2", "]"}], 
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"a", "[", "2", "]"}]}], " ", 
       RowBox[{"b", "[", "1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], " ", 
       RowBox[{"b", "[", "2", "]"}]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.7141088543864717`*^9, 3.714109179807962*^9, {3.714109702085415*^9, 
   3.714106673770583*^9}, 3.7153410065641108`*^9, 3.715341720520486*^9, 
   3.7153565771975574`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"b", "[", "2", "]"}], 
   RowBox[{
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", "2", "]"}], " ", 
       RowBox[{"b", "[", "1", "]"}]}], "-", 
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], " ", 
       RowBox[{"b", "[", "2", "]"}]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.7141088543864717`*^9, 3.714109179807962*^9, {3.714109702085415*^9, 
   3.714106673770583*^9}, 3.7153410065641108`*^9, 3.715341720520486*^9, 
   3.7153565772209797`*^9}]
}, Open  ]],

Cell["\<\
When using the second syntax, the input list of poles does not have to \
contain all points in the variety defined by the ideal (i.e., the set of \
points where all denominator factors vanish). Moreover, it may contain \
additional points (although the corresponding residues will be zero). As an \
example, consider the following ideal,\
\>", "Text",
 CellChangeTimes->{3.692435719210285*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ideal", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "1", "]"}], "^", "2"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"z", "[", "1", "]"}], "-", 
        RowBox[{"z", "[", "2", "]"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"z", "[", "3", "]"}], "^", "3"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "2", "]"}], "^", "3"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        RowBox[{"z", "[", "1", "]"}], "-", 
        RowBox[{"a", " ", 
         RowBox[{"z", "[", "1", "]"}]}], "+", 
        RowBox[{"z", "[", "2", "]"}], "+", 
        RowBox[{"a", " ", 
         RowBox[{"z", "[", "1", "]"}], " ", 
         RowBox[{"z", "[", "3", "]"}]}]}], ")"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Parameters", "=", 
   RowBox[{"{", "a", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z", "[", "1", "]"}], ",", 
     RowBox[{"z", "[", "2", "]"}], ",", 
     RowBox[{"z", "[", "3", "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6914115741698513`*^9, 3.6914116542208357`*^9}, {
  3.691411843535255*^9, 3.691411854396575*^9}, {3.691411931246294*^9, 
  3.691411934370378*^9}, {3.691412055881947*^9, 3.691412056186757*^9}, {
  3.6914159337892513`*^9, 3.69141595767474*^9}}],

Cell["The resulting variety contains three points,", "Text",
 CellChangeTimes->{3.692435744036729*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Variety", "=", 
  RowBox[{"Map", "[", 
   RowBox[{"Last", ",", 
    RowBox[{"Sort", "[", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"Ideal", "\[Equal]", "0"}], ",", "Vars"}], "]"}], "]"}], ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.691412061921904*^9, 3.691412065661186*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.691412066894911*^9, 3.69141661154737*^9, 3.691417193331414*^9, 
   3.69243562811637*^9, 3.692436348246643*^9, 3.692436388621929*^9, 
   3.692439712293515*^9, 3.693833214184181*^9, 3.714025232781869*^9, 
   3.714105007208907*^9, 3.714108696583312*^9, 3.714108747402672*^9, 
   3.714109180006432*^9, {3.714109702279045*^9, 3.7141066738536463`*^9}, 
   3.715341010670855*^9, 3.715341725823567*^9, 3.715356584461893*^9}]
}, Open  ]],

Cell["\<\
We may ask for the residue computed at precisely the poles contained in the \
variety, or alternatively a subset, or alternatively a subset with an added \
random point,\
\>", "Text",
 CellChangeTimes->{
  3.692435752062818*^9, {3.693833237079547*^9, 3.6938332476730957`*^9}, 
   3.6941666192717395`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MultivariateResidue", "[", 
  RowBox[{"1", ",", "Ideal", ",", "Vars", ",", "Variety"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MultivariateResidue", "[", 
  RowBox[{"1", ",", "Ideal", ",", "Vars", ",", 
   RowBox[{"Variety", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MultivariateResidue", "[", 
  RowBox[{"1", ",", "Ideal", ",", "Vars", ",", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Variety", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}], "}"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6914121014040613`*^9, 3.691412104667852*^9}, {
  3.693833227426511*^9, 3.693833231690619*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["6", "a"]}], ",", "0", ",", 
   FractionBox["6", "a"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.693833252705131*^9, 3.714025235536683*^9, 3.714105009695187*^9, 
   3.714108696722337*^9, 3.714108747544015*^9, 3.714109180231597*^9, {
   3.7141097024996*^9, 3.714106674024764*^9}, 3.715341013640788*^9, 
   3.715341727320012*^9, 3.7153565846360254`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["6", "a"]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.693833252705131*^9, 3.714025235536683*^9, 3.714105009695187*^9, 
   3.714108696722337*^9, 3.714108747544015*^9, 3.714109180231597*^9, {
   3.7141097024996*^9, 3.714106674024764*^9}, 3.715341013640788*^9, 
   3.715341727320012*^9, 3.7153565847761493`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["6", "a"]}], ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.693833252705131*^9, 3.714025235536683*^9, 3.714105009695187*^9, 
   3.714108696722337*^9, 3.714108747544015*^9, 3.714109180231597*^9, {
   3.7141097024996*^9, 3.714106674024764*^9}, 3.715341013640788*^9, 
   3.715341727320012*^9, 3.7153565849145017`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Performance", "Subsection",
 CellChangeTimes->{{3.691415892046155*^9, 3.691415914364788*^9}, 
   3.6925119758030663`*^9}],

Cell["\<\
The default method \[OpenCurlyDoubleQuote]TransformationFormula\
\[CloseCurlyDoubleQuote] is typically the best choice for simple problems, \
whereas the sophisticated \[OpenCurlyDoubleQuote]QuotientRingDuality\
\[CloseCurlyDoubleQuote] can offer speed improvements in more involved \
computations. For instance, the default method is the fastest method for the \
residue computation with the simple ideal defined above,\
\>", "Text",
 CellChangeTimes->{{3.692435782062469*^9, 3.6924357895764914`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ideal", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "1", "]"}], "^", "2"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"z", "[", "1", "]"}], "-", 
        RowBox[{"z", "[", "2", "]"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"z", "[", "3", "]"}], "^", "3"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "2", "]"}], "^", "3"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        RowBox[{"z", "[", "1", "]"}], "-", 
        RowBox[{"a", " ", 
         RowBox[{"z", "[", "1", "]"}]}], "+", 
        RowBox[{"z", "[", "2", "]"}], "+", 
        RowBox[{"a", " ", 
         RowBox[{"z", "[", "1", "]"}], " ", 
         RowBox[{"z", "[", "3", "]"}]}]}], ")"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z", "[", "1", "]"}], ",", 
     RowBox[{"z", "[", "2", "]"}], ",", 
     RowBox[{"z", "[", "3", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Variety", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Last", ",", 
     RowBox[{"Sort", "[", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"Ideal", "\[Equal]", "0"}], ",", "Vars"}], "]"}], "]"}], ",", 
     
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"First", "[", 
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{"MultivariateResidue", "[", 
    RowBox[{"1", ",", "Ideal", ",", "Vars", ",", "Variety", ",", 
     RowBox[{"Method", "\[Rule]", "\"\<TransformationFormula\>\""}]}], "]"}], 
   "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"First", "[", 
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{"MultivariateResidue", "[", 
    RowBox[{"1", ",", "Ideal", ",", "Vars", ",", "Variety", ",", 
     RowBox[{"Method", "\[Rule]", "\"\<QuotientRingDuality\>\""}]}], "]"}], 
   "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.691415732125646*^9, 3.6914157578880463`*^9}, {
   3.6914164969540367`*^9, 3.6914165070073757`*^9}, {3.6924358495192423`*^9, 
   3.692435850026085*^9}, {3.693916296637321*^9, 3.693916319282542*^9}, 
   3.693916350263483*^9, {3.693917032722293*^9, 3.693917032892478*^9}, {
   3.694153635885496*^9, 3.694153636113634*^9}}],

Cell[BoxData["0.29843599999999997907096371818624902517`5.495451123696604"], \
"Output",
 CellChangeTimes->{
  3.6924364035103292`*^9, 3.692439719346375*^9, 3.693833266412072*^9, 
   3.6938333256381598`*^9, 3.6938336751584377`*^9, 3.693840479590496*^9, 
   3.693840725573667*^9, 3.693916238313558*^9, {3.693916294273912*^9, 
   3.693916320169683*^9}, 3.693916352460538*^9, 3.693917033796026*^9, 
   3.694154135696888*^9, 3.7153410210753403`*^9, 3.715341736630189*^9}],

Cell[BoxData["4.63428299999999993019628163892775774002`6.686582464439579"], \
"Output",
 CellChangeTimes->{
  3.6924364035103292`*^9, 3.692439719346375*^9, 3.693833266412072*^9, 
   3.6938333256381598`*^9, 3.6938336751584377`*^9, 3.693840479590496*^9, 
   3.693840725573667*^9, 3.693916238313558*^9, {3.693916294273912*^9, 
   3.693916320169683*^9}, 3.693916352460538*^9, 3.693917033796026*^9, 
   3.694154135696888*^9, 3.7153410210753403`*^9, 3.715341741266141*^9}]
}, Open  ]],

Cell["\<\
A circumstance under which \[OpenCurlyDoubleQuote]QuotientRingDuality\
\[CloseCurlyDoubleQuote] performs better than \
\[OpenCurlyDoubleQuote]TransformationFormula\[CloseCurlyDoubleQuote] is when \
points in the variety are large rational functions of one or more parameters. \
In such cases, the computation of Groebner bases in \
\[OpenCurlyDoubleQuote]TransformationFormula\[CloseCurlyDoubleQuote] can be \
rather slow. The following example with two complex variables illustrates \
this point.\
\>", "Text",
 CellChangeTimes->{{3.69243588485331*^9, 3.692435907181774*^9}, 
   3.694152621309338*^9, {3.694166408087942*^9, 3.6941664090126276`*^9}, 
   3.715341906467784*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ideal", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"c", "[", "1", "]"}], " ", 
         RowBox[{"z", "[", "1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"c", "[", "2", "]"}], " ", 
         RowBox[{"z", "[", "2", "]"}]}]}], ")"}], "^", "2"}], ",", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"c", "[", "3", "]"}], " ", 
       RowBox[{"z", "[", "1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"c", "[", "4", "]"}], " ", 
       RowBox[{"z", "[", "2", "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z", "[", "1", "]"}], ",", 
     RowBox[{"z", "[", "2", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Variety", "=", 
  RowBox[{"Map", "[", 
   RowBox[{"Last", ",", 
    RowBox[{"Sort", "[", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"Ideal", "\[Equal]", "0"}], ",", "Vars"}], "]"}], "]"}], ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.692355808477833*^9, 3.692355810607168*^9}, {
   3.692355842454673*^9, 3.69235585069173*^9}, {3.692355899976213*^9, 
   3.692355927847639*^9}, 3.692355959696629*^9, 3.69235651155163*^9, {
   3.69243592659612*^9, 3.692435934373673*^9}, {3.693922470596258*^9, 
   3.693922548501629*^9}, {3.693922663690174*^9, 3.693922674877206*^9}, {
   3.693922774035997*^9, 3.693922797555978*^9}, {3.6939229745429907`*^9, 
   3.6939229857896833`*^9}, 3.693923022357265*^9, {3.693923093491363*^9, 
   3.6939231000166683`*^9}, {3.6939231836159573`*^9, 3.693923185352992*^9}, {
   3.693923333624477*^9, 3.693923334162328*^9}, {3.694152624031461*^9, 
   3.694152626566757*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"c", "[", "2", "]"}], "-", 
       RowBox[{"c", "[", "4", "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"c", "[", "2", "]"}], " ", 
        RowBox[{"c", "[", "3", "]"}]}], "-", 
       RowBox[{
        RowBox[{"c", "[", "1", "]"}], " ", 
        RowBox[{"c", "[", "4", "]"}]}]}]]}], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"-", 
        RowBox[{"c", "[", "1", "]"}]}], "+", 
       RowBox[{"c", "[", "3", "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"c", "[", "2", "]"}], " ", 
        RowBox[{"c", "[", "3", "]"}]}], "-", 
       RowBox[{
        RowBox[{"c", "[", "1", "]"}], " ", 
        RowBox[{"c", "[", "4", "]"}]}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.6923558185419283`*^9, 3.69235583618962*^9}, {
   3.692355900368741*^9, 3.692355931627988*^9}, {3.692355963725348*^9, 
   3.6923559752020903`*^9}, 3.692356051672894*^9, 3.692356520504552*^9, 
   3.6923578807048483`*^9, 3.692420858883772*^9, 3.6924209002488937`*^9, 
   3.692421127238077*^9, 3.6924235420288897`*^9, 3.692436352978455*^9, 
   3.692436416388939*^9, 3.692439729773966*^9, 3.69383336207726*^9, 
   3.693833685344577*^9, 3.6939194736271048`*^9, 3.693922443563242*^9, 
   3.69392254915704*^9, {3.693922666542145*^9, 3.693922696371393*^9}, {
   3.693922779494012*^9, 3.693922817732657*^9}, {3.693923016497724*^9, 
   3.693923022698571*^9}, 3.6939231010163593`*^9, 3.6939231868223*^9, 
   3.693923334765929*^9, 3.694152629532733*^9, 3.694154187654456*^9, 
   3.694154221321598*^9, 3.715341498850232*^9, 3.7153419098055468`*^9}]
}, Open  ]],

Cell["\<\
Since this variety is a rational function of coefficients c(i), \
\>", "Text",
 CellChangeTimes->{
  3.6924359169152527`*^9, {3.694152647620246*^9, 3.694152660131195*^9}, {
   3.6941664156143627`*^9, 3.694166415834919*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"First", "[", 
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{"MultivariateResidue", "[", 
    RowBox[{"1", ",", "Ideal", ",", "Vars", ",", "Variety", ",", 
     RowBox[{"Method", "\[Rule]", "\"\<TransformationFormula\>\""}]}], "]"}], 
   "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"First", "[", 
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{"MultivariateResidue", "[", 
    RowBox[{"1", ",", "Ideal", ",", "Vars", ",", "Variety", ",", 
     RowBox[{"Method", "\[Rule]", "\"\<QuotientRingDuality\>\""}]}], "]"}], 
   "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.693923191399952*^9, 3.693923193383596*^9}, {
  3.694154207440658*^9, 3.694154208271202*^9}}],

Cell[BoxData["0.18517400000000000526156895830354187638`5.288179921277728"], \
"Output",
 CellChangeTimes->{3.715341504348419*^9, 3.715341913942328*^9}],

Cell[BoxData["0.08449299999999999866151512151191127487`4.9474206436813875"], \
"Output",
 CellChangeTimes->{3.715341504348419*^9, 3.715341914028689*^9}]
}, Open  ]],

Cell["\<\
The method \[OpenCurlyDoubleQuote]QuotientRingDuality\[CloseCurlyDoubleQuote] \
allows the use of various monomial orderings in the computation of Groebner \
bases, which can impact the speed of subsequent polynomial reductions. \
Considering once again the ideal defined above and computing the multivariate \
residue using three different monomial orderings,\
\>", "Text",
 CellChangeTimes->{
  3.6924360983563004`*^9, {3.692454403590313*^9, 3.692454405928069*^9}, {
   3.6941668886272583`*^9, 3.6941669089076085`*^9}, {3.694166978639553*^9, 
   3.6941669841282787`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ideal", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"z", "[", "1", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"z", "[", "1", "]"}], "3"], "-", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"z", "[", "1", "]"}], "2"], " ", 
       RowBox[{"z", "[", "2", "]"}]}]}], ",", 
     SuperscriptBox[
      RowBox[{"z", "[", "3", "]"}], "3"], ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "3"]}], "-", 
      RowBox[{
       RowBox[{"z", "[", "1", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "3"]}], "-", 
      RowBox[{"a", " ", 
       RowBox[{"z", "[", "1", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "3"]}], "+", 
      SuperscriptBox[
       RowBox[{"z", "[", "2", "]"}], "4"], "+", 
      RowBox[{"a", " ", 
       RowBox[{"z", "[", "1", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "3"], " ", 
       RowBox[{"z", "[", "3", "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z", "[", "1", "]"}], ",", 
     RowBox[{"z", "[", "2", "]"}], ",", 
     RowBox[{"z", "[", "3", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Variety", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Last", ",", 
     RowBox[{"Sort", "[", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"Ideal", "\[Equal]", "0"}], ",", "Vars"}], "]"}], "]"}], ",", 
     
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"First", "[", 
    RowBox[{"AbsoluteTiming", "[", 
     RowBox[{"MultivariateResidue", "[", 
      RowBox[{"1", ",", "Ideal", ",", "Vars", ",", "Variety", ",", 
       RowBox[{"Method", "\[Rule]", "\"\<QuotientRingDuality\>\""}], ",", 
       RowBox[{"MonomialOrder", "\[Rule]", "#"}]}], "]"}], "]"}], "]"}], 
   "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{
   "Lexicographic", ",", "DegreeLexicographic", ",", 
    "DegreeReverseLexicographic"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.692429464145629*^9, 3.6924294852980556`*^9}, {
  3.692436183532291*^9, 3.692436183999758*^9}, {3.693841335842301*^9, 
  3.693841336307829*^9}, {3.693922052082747*^9, 3.6939220600427713`*^9}, {
  3.694154239806438*^9, 3.694154244957315*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4.86614799999999991797494658385403454304`6.707785226794659", ",", 
   "1.90682499999999999218402990663889795542`6.300910750519773", ",", 
   "2.16643499999999988858689903281629085541`6.3563455766178"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7153415205361643`*^9, 3.715341932927936*^9}]
}, Open  ]],

Cell["\<\
shows that the options DegreeLexicographic and DegreeReverseLexicographic are \
noticeably faster than Lexicographic.\
\>", "Text",
 CellChangeTimes->{3.692436144825183*^9}],

Cell["\<\
In some problems, in particular when facing many residue computations, a \
straightforward way to decrease the total running time is by performing the \
computations in parallel. This can be achieved by distributing the \
definitions in MultivariateResidues` over the kernels\
\>", "Text",
 CellChangeTimes->{{3.694152814040856*^9, 3.694152894771407*^9}, 
   3.694153222226097*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "DistributeDefinitions", "[", "\"\<MultivariateResidues`\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.694152847784752*^9, 3.6941528477859592`*^9}, {
  3.6941528977883883`*^9, 3.694152956516733*^9}, {3.69415299543934*^9, 
  3.694153062025724*^9}}],

Cell["and running ParallelMap", "Text",
 CellChangeTimes->{{3.694153224136929*^9, 3.694153225688554*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ideal", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"z", "[", "1", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"z", "[", "1", "]"}], "3"], "-", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"z", "[", "1", "]"}], "2"], " ", 
       RowBox[{"z", "[", "2", "]"}]}]}], ",", 
     SuperscriptBox[
      RowBox[{"z", "[", "3", "]"}], "3"], ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "3"]}], "-", 
      RowBox[{
       RowBox[{"z", "[", "1", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "3"]}], "-", 
      RowBox[{"a", " ", 
       RowBox[{"z", "[", "1", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "3"]}], "+", 
      SuperscriptBox[
       RowBox[{"z", "[", "2", "]"}], "4"], "+", 
      RowBox[{"a", " ", 
       RowBox[{"z", "[", "1", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "3"], " ", 
       RowBox[{"z", "[", "3", "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z", "[", "1", "]"}], ",", 
     RowBox[{"z", "[", "2", "]"}], ",", 
     RowBox[{"z", "[", "3", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Variety", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Last", ",", 
     RowBox[{"Sort", "[", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"Ideal", "\[Equal]", "0"}], ",", "Vars"}], "]"}], "]"}], ",", 
     
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ideals", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Ideal", "/.", 
       RowBox[{"{", 
        RowBox[{"a", "\[Rule]", 
         RowBox[{"a", "[", "i", "]"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"First", "[", 
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MultivariateResidue", "[", 
       RowBox[{"1", ",", "#", ",", "Vars", ",", "Variety"}], "]"}], "&"}], 
     ",", "Ideals"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"First", "[", 
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{"ParallelMap", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MultivariateResidue", "[", 
       RowBox[{"1", ",", "#", ",", "Vars", ",", "Variety"}], "]"}], "&"}], 
     ",", "Ideals"}], "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6941530681371403`*^9, 3.694153070913189*^9}, {
  3.694153177765647*^9, 3.694153181357443*^9}, {3.69415331592023*^9, 
  3.694153315994205*^9}, {3.694153351407453*^9, 3.694153351967383*^9}, {
  3.69415338759339*^9, 3.694153411222684*^9}, {3.69415358220894*^9, 
  3.694153606515921*^9}}],

Cell[BoxData["27.64549200000000084287421486806124448776`7.462224236654895"], \
"Output",
 CellChangeTimes->{3.694153619047935*^9}],

Cell[BoxData["14.54461599999999954491158860037103295326`7.1833021729787205"], \
"Output",
 CellChangeTimes->{3.694153633593012*^9}]
}, Open  ]],

Cell["\<\
Finally, it is worth mentioning that multivariate residue calculations can be \
simplified \[Dash] where possible \[Dash] by appropriate use of partial \
fractioning. Suppose one is computing the residues of R(z_1, z_2) = (z_1 f_1 \
+ z_2 f_3)/(f_1 f_2 f_3 f_4), where f_i = a_i z_1 + b_i z_2, with respect to \
the ideal I = \[LeftAngleBracket] f_1 f_2 , f_3 f_4 \[RightAngleBracket]. A \
direct computation of the residue yields\
\>", "Text",
 CellChangeTimes->{{3.692436201246161*^9, 3.692436252522025*^9}, {
  3.692454364124329*^9, 3.692454371439907*^9}, {3.6925120185677013`*^9, 
  3.6925120300295877`*^9}, {3.692512139294613*^9, 3.692512148130233*^9}, {
  3.694167065221484*^9, 3.6941670865058403`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "i", "]"}], " ", 
     RowBox[{"z", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"b", "[", "i", "]"}], " ", 
     RowBox[{"z", "[", "2", "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"T", "[", "1", "]"}], ",", 
    RowBox[{"Res", "[", "1", "]"}]}], "}"}], "=", 
  RowBox[{
   RowBox[{"MultivariateResidue", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "1", "]"}], 
       RowBox[{"F", "[", "1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"z", "[", "2", "]"}], 
       RowBox[{"F", "[", "3", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"F", "[", "1", "]"}], 
        RowBox[{"F", "[", "2", "]"}]}], ",", 
       RowBox[{
        RowBox[{"F", "[", "3", "]"}], 
        RowBox[{"F", "[", "4", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"z", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
       RowBox[{
        RowBox[{"z", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}]}], "]"}], "//",
    "AbsoluteTiming"}]}]}], "Input",
 CellChangeTimes->{{3.692436279586664*^9, 3.692436279724506*^9}, {
  3.6925120353215733`*^9, 3.692512101617773*^9}, {3.6925123104113197`*^9, 
  3.692512317717228*^9}, {3.693833495122426*^9, 3.693833512495775*^9}, {
  3.714105618397544*^9, 3.714105627452468*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.45413300000000000888888962435885332525`5.67778297474275", ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", "3", "]"}], " ", 
       RowBox[{"a", "[", "4", "]"}], " ", 
       RowBox[{"b", "[", "2", "]"}]}], "+", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], " ", 
       RowBox[{"b", "[", "1", "]"}], " ", 
       RowBox[{"b", "[", "2", "]"}]}], "-", 
      RowBox[{
       RowBox[{"a", "[", "2", "]"}], " ", 
       RowBox[{"a", "[", "4", "]"}], " ", 
       RowBox[{"b", "[", "3", "]"}]}], "-", 
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], " ", 
       RowBox[{"b", "[", "2", "]"}], " ", 
       RowBox[{"b", "[", "4", "]"}]}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", "3", "]"}], " ", 
         RowBox[{"b", "[", "2", "]"}]}], "-", 
        RowBox[{
         RowBox[{"a", "[", "2", "]"}], " ", 
         RowBox[{"b", "[", "3", "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", "4", "]"}], " ", 
         RowBox[{"b", "[", "1", "]"}]}], "-", 
        RowBox[{
         RowBox[{"a", "[", "1", "]"}], " ", 
         RowBox[{"b", "[", "4", "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", "4", "]"}], " ", 
         RowBox[{"b", "[", "2", "]"}]}], "-", 
        RowBox[{
         RowBox[{"a", "[", "2", "]"}], " ", 
         RowBox[{"b", "[", "4", "]"}]}]}], ")"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.692512083051972*^9, 3.692512102297564*^9}, 
   3.692512327494869*^9, 3.6938334762326202`*^9, 3.693833539661776*^9, 
   3.715341532424735*^9}]
}, Open  ]],

Cell["\<\
Partial fractioning the rational function produces two terms, R(z_1,z_2) = \
z_1/(f_2 f_3 f_4) + z_2/(f_1 f_2 f_4). The residue of each of these terms \
should be computed with respect to the corresponding reduced ideals \
\[LeftAngleBracket] f_2 , f_3 f_4 \[RightAngleBracket] and \
\[LeftAngleBracket] f_1 f_2 , f_4 \[RightAngleBracket]. The sum of these two \
residues reproduces the result of the direct computation,\
\>", "Text",
 CellChangeTimes->{{3.692436301803975*^9, 3.6924363257173233`*^9}, {
  3.692453455576315*^9, 3.6924534576139507`*^9}, {3.6924543779308577`*^9, 
  3.692454393954619*^9}, {3.692512155822443*^9, 3.692512221308514*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"2", ",", "1"}], "]"}], ",", 
    RowBox[{"Res", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "}"}], "=", 
  RowBox[{
   RowBox[{"MultivariateResidue", "[", 
    RowBox[{
     RowBox[{"z", "[", "1", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{
        RowBox[{"F", "[", "3", "]"}], 
        RowBox[{"F", "[", "4", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"z", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
       RowBox[{
        RowBox[{"z", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}]}], "]"}], "//",
    "AbsoluteTiming"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"2", ",", "2"}], "]"}], ",", 
    RowBox[{"Res", "[", 
     RowBox[{"2", ",", "2"}], "]"}]}], "}"}], "=", 
  RowBox[{
   RowBox[{"MultivariateResidue", "[", 
    RowBox[{
     RowBox[{"z", "[", "2", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"F", "[", "1", "]"}], 
        RowBox[{"F", "[", "2", "]"}]}], ",", 
       RowBox[{"F", "[", "4", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"z", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
       RowBox[{
        RowBox[{"z", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}]}], "]"}], "//",
    "AbsoluteTiming"}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Res", "[", "1", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{"Res", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "+", 
    RowBox[{"Res", "[", 
     RowBox[{"2", ",", "2"}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.692436294825466*^9, 3.6924362949612617`*^9}, {
  3.692512112165593*^9, 3.692512127160141*^9}, {3.693833518178585*^9, 
  3.693833537097267*^9}, {3.7141056312362223`*^9, 3.7141056356290083`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.03558599999999999957678298301289032679`4.571879087696603", ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"b", "[", "2", "]"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", "3", "]"}], " ", 
         RowBox[{"b", "[", "2", "]"}]}], "-", 
        RowBox[{
         RowBox[{"a", "[", "2", "]"}], " ", 
         RowBox[{"b", "[", "3", "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", "4", "]"}], " ", 
         RowBox[{"b", "[", "2", "]"}]}], "-", 
        RowBox[{
         RowBox[{"a", "[", "2", "]"}], " ", 
         RowBox[{"b", "[", "4", "]"}]}]}], ")"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.692436458454616*^9, 3.6924397728736773`*^9, 
  3.692512130319488*^9, 3.692512329194013*^9, 3.6938334783368597`*^9, 
  3.693833545605588*^9, 3.71534154167365*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.03980100000000000304289926589262904599`4.6204938971378855", ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"a", "[", "4", "]"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", "4", "]"}], " ", 
         RowBox[{"b", "[", "1", "]"}]}], "-", 
        RowBox[{
         RowBox[{"a", "[", "1", "]"}], " ", 
         RowBox[{"b", "[", "4", "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", "4", "]"}], " ", 
         RowBox[{"b", "[", "2", "]"}]}], "-", 
        RowBox[{
         RowBox[{"a", "[", "2", "]"}], " ", 
         RowBox[{"b", "[", "4", "]"}]}]}], ")"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.692436458454616*^9, 3.6924397728736773`*^9, 
  3.692512130319488*^9, 3.692512329194013*^9, 3.6938334783368597`*^9, 
  3.693833545605588*^9, 3.715341541715706*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.692436458454616*^9, 3.6924397728736773`*^9, 
  3.692512130319488*^9, 3.692512329194013*^9, 3.6938334783368597`*^9, 
  3.693833545605588*^9, 3.715341541791438*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"T", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "+", 
  RowBox[{"T", "[", 
   RowBox[{"2", ",", "2"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"T", "[", "1", "]"}]}], "Input",
 CellChangeTimes->{{3.693833549786322*^9, 3.6938335707686357`*^9}}],

Cell[BoxData["0.07538700000000000261968224890551937278`4.596866378670695"], \
"Output",
 CellChangeTimes->{{3.693833565015873*^9, 3.69383357120065*^9}, 
   3.715341544406665*^9}],

Cell[BoxData["0.45413300000000000888888962435885332525`5.67778297474275"], \
"Output",
 CellChangeTimes->{{3.693833565015873*^9, 3.69383357120065*^9}, 
   3.715341544408484*^9}]
}, Open  ]]
}, Closed]]
},
WindowSize->{1536, 781},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
ShowSelection->True,
Magnification:>1.25 Inherited,
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 549, 12, 72, "Input"],
Cell[1131, 36, 369, 6, 27, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1537, 47, 180, 3, 48, "Input"],
Cell[1720, 52, 2626, 72, 94, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4383, 129, 125, 2, 44, "Subsection"],
Cell[4511, 133, 255, 5, 38, "Text"],
Cell[CellGroupData[{
Cell[4791, 142, 519, 14, 98, "Input"],
Cell[5313, 158, 554, 9, 48, "Output"],
Cell[5870, 169, 554, 9, 48, "Output"]
}, Open  ]],
Cell[6439, 181, 475, 8, 63, "Text"],
Cell[CellGroupData[{
Cell[6939, 193, 2227, 74, 164, "Input"],
Cell[9169, 269, 343, 9, 71, "Output"],
Cell[9515, 280, 603, 18, 70, "Output"],
Cell[10121, 300, 579, 17, 70, "Output"]
}, Open  ]],
Cell[10715, 320, 403, 7, 63, "Text"],
Cell[11121, 329, 1436, 41, 95, "Input"],
Cell[12560, 372, 102, 1, 38, "Text"],
Cell[CellGroupData[{
Cell[12687, 377, 350, 9, 48, "Input"],
Cell[13040, 388, 722, 16, 48, "Output"]
}, Open  ]],
Cell[13777, 407, 314, 7, 38, "Text"],
Cell[CellGroupData[{
Cell[14116, 418, 827, 21, 95, "Input"],
Cell[14946, 441, 426, 10, 67, "Output"],
Cell[15375, 453, 394, 9, 67, "Output"],
Cell[15772, 464, 404, 9, 67, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16225, 479, 127, 2, 44, "Subsection"],
Cell[16355, 483, 512, 8, 76, "Text"],
Cell[CellGroupData[{
Cell[16892, 495, 2295, 61, 165, "Input"],
Cell[19190, 558, 466, 7, 58, "Output"],
Cell[19659, 567, 466, 7, 58, "Output"]
}, Open  ]],
Cell[20140, 577, 686, 12, 106, "Text"],
Cell[CellGroupData[{
Cell[20851, 593, 1782, 45, 112, "Input"],
Cell[22636, 640, 1690, 40, 88, "Output"]
}, Open  ]],
Cell[24341, 683, 233, 5, 46, "Text"],
Cell[CellGroupData[{
Cell[24599, 692, 682, 14, 86, "Input"],
Cell[25284, 708, 151, 2, 58, "Output"],
Cell[25438, 712, 152, 2, 58, "Output"]
}, Open  ]],
Cell[25605, 717, 583, 10, 76, "Text"],
Cell[CellGroupData[{
Cell[26213, 731, 2421, 69, 172, "Input"],
Cell[28637, 802, 332, 7, 58, "Output"]
}, Open  ]],
Cell[28984, 812, 183, 4, 46, "Text"],
Cell[29170, 818, 391, 7, 76, "Text"],
Cell[29564, 827, 293, 7, 58, "Input"],
Cell[29860, 836, 105, 1, 46, "Text"],
Cell[CellGroupData[{
Cell[29990, 841, 2923, 85, 225, "Input"],
Cell[32916, 928, 130, 2, 58, "Output"],
Cell[33049, 932, 131, 2, 58, "Output"]
}, Open  ]],
Cell[33195, 937, 719, 11, 106, "Text"],
Cell[CellGroupData[{
Cell[33939, 952, 1452, 44, 86, "Input"],
Cell[35394, 998, 1720, 49, 110, "Output"]
}, Open  ]],
Cell[37129, 1050, 660, 10, 95, "Text"],
Cell[CellGroupData[{
Cell[37814, 1064, 1942, 59, 140, "Input"],
Cell[39759, 1125, 918, 25, 110, "Output"],
Cell[40680, 1152, 923, 26, 110, "Output"],
Cell[41606, 1180, 215, 3, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41858, 1188, 278, 7, 107, "Input"],
Cell[42139, 1197, 178, 3, 72, "Output"],
Cell[42320, 1202, 177, 3, 72, "Output"]
}, Open  ]]
}, Closed]]
}
]
*)

